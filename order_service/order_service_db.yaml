apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres-database-order-service
spec:
  replicas: 1
  selector:
    matchLabels:
      app: postgres-database-order-service
  template:
    metadata:
      labels:
        app: postgres-database-order-service
    spec:
      containers:
        - name: postgres-container
          image: postgres:16
          ports:
            - containerPort: 5436 
          env:
            - name: POSTGRES_HOST_AUTH_METHOD
              value: md5
            - name: POSTGRES_USER  
              valueFrom:
                secretKeyRef:
                  name: db-orders-credentials
                  key: db.order_service.username
            - name: POSTGRES_PASSWORD  
              valueFrom:
                secretKeyRef:
                  name: db-orders-credentials
                  key: db.order_service.password
---
apiVersion: v1
kind: Service
metadata:
  name: postgres-order-service
spec:
  selector:
    app: postgres-database-order-service
  ports:
    - protocol: TCP
      port: 5436
      targetPort: 5432
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: db-orders-credentials
  namespace: default
spec:
  encryptedData:
    db.order_service.password: AgCjaEAh6NBryeV7Mh7sAF2LI1xuEbohY2GNF0sVS5abR//rltvFJE4OTUkTOf1wqfcdBasiHLfArQFGVwf0jpAqOrRuOqIS+MNl9hd2Awwn7W5NBcU5BEyGexHzUCGKRzSiO18l83XEBGS0LC+z62Iwpv4LjudpeJjBgMM7DttqpvZWyamyiPx42LcUWBX81L4uY+SoOBMzeKfTFlYByWfgQT5UgCzGmVr8JOQBgOAN37PTRmjKRwzeMCJnRSdFSwU7lBsWBvRobpuxU9kIOa7zu1u1lWVsIRdQ6ZQHBnLyN+LoGIFlmHftId/0xCO4pWyQqArYbF3FQjN+yEO178qyV1t811D39tWXWooH1llIBIZTWFmUBWPEf+3QVWccwANpPeANOJ1uVSu5YDI0qgugsM68XFYD3rwTIQ1m87bN9zhS6cOsVzFE9jnNTMRamhVdbM+nwQfFQhE7DihQNThWiLziuqAXSBYbll+ue6uDWH2urTqVMVzReJd1Mi7ZR/uopd8UG6dkuNymWGr9DEVGfqlmuZbRJrLZXqQieKGqASIwe8zjDJYxtngJMOW16QiejDC5flpzzaGEv8uz6/VYg8VbsTrvuwp5oflkZ1ZhLjYeg8i5wvrIgqJFJavATPt5e+MSD1nrON84PPnNBLxQHx45hlv8Z+Auik5FE440wFZhpbTZmr/Gv6FCBEYj2UQpliyc8Yors+eBpAc=
    db.order_service.username: AgCrV2osQbfacXOOnjixTkIh6QigGonMQraVVLwuDxih1GIJ+4Eww3A4hvFl/2tOohert013McZyS1HhIsq7+G6uYJzDSFTTW8T3q6YhxO+LLg1U8Eu3noHJjGzXgz0EwpYtKd2pxL6EhAqygu/hCnUJC+q7BLshuOZOUzelP4t+8k7Mbx9dCJ23uesz/TvRcfp49Hs+/m5BWwUn088j6CfBC38EoVC2FhW/cECmMn6gyu2yWHZ26oJa0VUiQ52O7Zga+Q3sMYxLeqZRLjHnytxWq8pzly0i0dsHfivuD9922e+Hy7C1N2iq5DIQtmYLfAWEnU3RFIYvmyw18M18b265iNJmzGTeELNBTZTLQCAlVtXMmkECzilftl6ZM5AORW+/RHZkSU4VfQi4JQEqjYlg/At7AqYbhK3mAQcaXjMoW3VsKmgajEBkmIpJVXdFW5qYkF/8+gy0JG8aGHfdc27mgPxa/sj57kR3Nmh3O+8w1gjlS7X2+7sstHkwbOPHlIgRT86D5aXZ2MzY4Ni3yGxqHy6eGwL7NaF1zQRt3zaZZsERmrMfvr6ZUAQkBI+iNLheBx3NqPNLX1sMavKiFRvGoG/tRXpk1fPuyZY7oRKzjtz2rAkz4Ae5qTXSieaGgDez6Pq5Z1VwPv2CJF+HUbePAsevP9vrt8MJD0ZG8GGmPTStwSSC/eLyn6Dk8e7Hj6gOyiUJa89SvSbM
  template:
    metadata:
      creationTimestamp: null
      name: db-orders-credentials
      namespace: default