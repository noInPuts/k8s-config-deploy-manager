apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres-database-order-service
spec:
  replicas: 1
  selector:
    matchLabels:
      app: postgres-database-order-service
  template:
    metadata:
      labels:
        app: postgres-database-order-service
    spec:
      containers:
        - name: postgres-container
          image: postgres:16
          ports:
            - containerPort: 5436 
          env:
            - name: POSTGRES_HOST_AUTH_METHOD
              value: md5
            - name: POSTGRES_USER  
              valueFrom:
                secretKeyRef:
                  name: db-order-credentials
                  key: db.order_service.username
            - name: POSTGRES_PASSWORD  
              valueFrom:
                secretKeyRef:
                  name: db-order-credentials
                  key: db.order_service.password
---
apiVersion: v1
kind: Service
metadata:
  name: postgres-order-service
spec:
  selector:
    app: postgres-database-order-service
  ports:
    - protocol: TCP
      port: 5436
      targetPort: 5432
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: db-order-credentials
  namespace: default
spec:
  encryptedData:
    db.order_service.password: AgBirLe4fuN2dcsyckyXBVMhQLfbHus9mF2c6YiA40qbMbFai1mOarIDOfpgbz9LmsXTNn9+f6uLKGlJy/zgsNepo9SeG8j8URbI3TltBbVgbUno/P5OBHvNf+7/0lu50Ndr3IN+A8AmvWXWctdjWL9mo/0UY9SN+TugToli7EIFGOb99zfZjdm5I/4JMcp5GoBMRodXq4VD53rXcXo3zhZhoVRh+J6BaXnhFt61YiosJGwcQ6R3Sno+tRfz6vDyKKBTwA+Su28TCR7dhiAIdZbUuy/g4k/P7SlVYpI3FVfqRKGYyKjQS07a13v8hhszVnA9fmihePDXirl/aS+bZ9wuJPidoSGABntItsaKkG/fO/3q8lYpPdJGD9MKgCF8OreE8es/A2tdvW4r902b2Q5cHjbj+TQTxDiWGGBvdiYWzH04SufzBv8I8jo/H5/BhD0j0orjaW7WfcBwhPqiNweEXvuCcwV8CTmAvETARnYqBZ7Vq6mevDWqAGH6J+nxRmEXxjtK4BIizBdrzIYuS/QrorrCYfK0YL5e8x2imUY1VkFWOLWG/LmlL1hUEIAYksOK1NAmmenRztA7kolXXZzAfr0VhLckWUswA/P17VToWh+8SZqoURihvxGsJEbgViaL2j01hgNZHjN3etzBe2ykQeeuFhkHEucO1hKBgawt2aY+Pizg2ideeWEF5Op9e/hywKqIWcQNDy4rMEw=
    db.order_service.username: AgBuUCwQN5EoJlks0Koq3e3wS+I+ehRppa5SovLqhv5ixoO18cZRy7X9IlnADIHeQPG7qZsiZcY92qNugAjaeJTg5q92uFH8++53Xsw4bGaUowma9nYqsmzHozBJPcmgaIYwUPZNKIXDWyecLXYVLazeUlSNxm7CgioY8/sHJWbNUn6uZHhOkRI1AmtbWsQcYtxfVga6Qdf25rb9rd1nym4QUcO+ovSG34BK8KET8/2pjCgDksJ7pQpoCFM9jKKeGMjurvVJS6ZC8AhH/scbahLSSDP5I7cCdIShuwU44sEZT6EG+8DwZTXn5/S023OBUHsOxoYtWPlKe5cW6eOUj3EYzyGmCumC/qPaFBtAH10UaLWZ5w4DUiDoSQaytdzrMZs2K5yK1x1SJRk8jrdghwBv1Uv7YCs1T/XoRYI6spIHpgQ8BFdJqD/2WAkGydsGcHm6LDentFy8JlkplsXbqArbvwTY1l2w2pyTFJOT0V6WH3cbKOlfWJ1HxtsEBRey9ae3artBWaUv3jg7nyLNX/+dewElUXAbQMI3GTk33s5ThGHyOZpKdq72ZBhrEHXI83Tak39WgSbHt8f64ty0i2q9j7qBZjM/Oqz6QKrCwYvdt0UAV+MAm/I8+EuoroCkvUz1ZhFVHtVex1HPPR/e6J0i++jhPK0jg2DxkFO1QQsuIGAtzG/9vRt3PLjXXmnvAODIMbjqzQi0+HDkAA==
  template:
    metadata:
      creationTimestamp: null
      name: db-order-credentials
      namespace: default